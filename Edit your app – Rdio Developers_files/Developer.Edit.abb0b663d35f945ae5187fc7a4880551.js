Bujagali.fxns["client/Components/Developer/Edit/Edit.bg.html"]=function(){return function(ctx,args){var self=this;var done=function(post){var markup=self.markup;if(args&&args._blockProviders){args._blockProviders=null}self.done(post);ctx=null;args=null;self=null;done=function(){};return markup};function emit(more){Array.prototype.splice.apply(self.markup,[self.markup.length,more.length].concat(more))}emit(['<div class="page_content">\n  ']);var __uniqueId=_.uniqueId("__bg_component");emit(['<div id="'+__uniqueId+'" />']);self.view.addChildFromTemplate(__uniqueId,self.view.editor,{inStateSection:self._inStateSection});emit(['\n  <div class="form_row last">\n    <button class="update button blue" disabled="disabled">Update</button>\n    <button class="cancel button">Cancel</button>\n    <p class="error_text for_form"></p>\n  </div>\n</div>\n']);return done()}}();R.StyleManager.loadComponentCss("Developer.Edit",".upper{text-transform:uppercase;}.Developer_Edit .button.blue{margin-right:15px;}.Developer_Edit .error_text{color:#cc4747;}");!function($){R.Component.create("Developer.Edit",{dependencies:["Developer.AppEditor"],cache:false,pageTitle:"Edit your app",events:{"click button.update":"updateApp","click button.cancel":"handleCancel"},modelFactory:function(){return new R.Models.Developer.AppInfo({client_id:this.options.urlMatches[0]})},onModelCreated:function(){if(!this.model.get("currentUserOwns")){this.trigger("fetchError")}this.model.set({required_permissions:_.intersection(this.model.get("required_permissions"),["shared_playstate"])})},changed:function(){var enable=this.editor.imageChanged("icon")||this.editor.imageChanged("galleryImage")||!_.isEmpty(this.changes());this._updateButton.attr({disabled:!enable})},changes:function(){return this.editor.removeUnchanged(this.editor.toJSON())},updateApp:function(){var self=this;var $error=this.$(".error_text.for_form");var valid=this.editor.validate();if(!valid){$error.text("Some fields are filled out incorrectly; please scroll back up and fix them.");return}$error.text("");var client_id=this.model.get("client_id");var dataDeferred=$.Deferred();if(!_.isEmpty(this.changes())){R.Api.request({method:"updateApplication",content:_.extend(this.changes(),{client_id:client_id}),success:function(data){dataDeferred.resolve()},error:function(data){dataDeferred.reject("Unable to update app: "+data.message)}})}else{dataDeferred.resolve()}$.when(dataDeferred,this.editor.uploadChangedImages()).done(function(){R.router.navigate("/developers/app/"+client_id+"/",true)}).fail(function(message){$error.text(message)})},handleCancel:function(){R.router.navigate("/developers/app/"+this.model.get("client_id")+"/",true)},onRendered:function(){this._updateButton=this.$("button.update");this.changed()},createChildComponents:function(){this.editor=new R.Components.Developer.AppEditor({model:this.model});this.listen(this.editor,"changed",this.changed)}})}(R.$);
//# sourceMappingURL=/media/client/orig/Components/Developer.Edit.abb0b663d35f945ae5187fc7a4880551.js.map